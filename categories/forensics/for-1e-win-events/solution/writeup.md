# Парольная система

|   Cобытие   | Название | Категория | Сложность |
| :---------: | :------: | :-------: | :-------: |
| VKACTF 2022 | Чудные комплюктеры |  Forensics  |  Легкая  |

## Описание

>Автор: b1bas
>
>Бывает, живешь себе, живешь, а тебе даже вспомнить нечего! А, кстати, соц. опрос: скажи мне, что было 26 мая 2022 года между 21:35 и 21:40? Ну что? Не можешь вспомнить? Я что-то делал с сервисами, но точно тоже вспомнить не могу... Как круто, что все эти ваши комплюктеры замечательные могут хранить в себе столько информации... А если бы они умели чувствовать? Представьте как бы им легко было вспоминать прожитое? Эх, как мне надоели уже эти альбомы, фотосессии с семьей, ... Почему нельзя просто поставить две галочки, и оно хоп: "логирует" всю твою жизнь. Стоп, или можно?

[DropMeFiles](https://dropmefiles.com/PKwEg)
[Google Disk](https://drive.google.com/file/d/19E2UmLB70ZGXt4mqdWQVDYp18qa9Ft8r/view?usp=sharing)

# Решение

Дана файловая система Windows. 
Из описания следует, что нужно искать что-то, что "логирует" информацию.
Порыскав на системе находим файлы EventTranscript.db и EventTrascript.db-shm. Они-то нам и нужны.

EventTranscript.db служит локальным хранилищем для подсистемы диагностики и телеметрии Windows, содержимое которой может отображаться с помощью приложения средства просмотра диагностических данных в Windows 10/Windows 11.

Все попытки найти и заюзать парсер не увенчаются успехом, т.к. в Windows11 (откуда и забирали) изменили ключи, которые отправляются в Microsoft.Windows

Есть два хода решения:

    1) Руками перебрать лог, найти единственный флаг в leet, сдать
    2) Монтировать данный лог к себе.

Каким образом это делается:

Включается отправка необязательных диагностических данных:
"Конфиденциальность и защита" -> "Диагности и отзывы" -> ставим везде галочки

Можете установить в Microsoft Store утилиту Diagnostic Data Viewer, чтобы посмотреть как это выглядит в нормальном виде.

В директории C:\ProgramData\Microsoft\Diagnosis\EventTranscript появятся файлы, которые надо удалить, и заменить их двумя найденными файлами (EventTranscript.db и EventTrascript.db-shm)

Далее перезагружаем систему и проверяем в Diagnostic Data Viewer, что события подгрузились.

По запросу "parse diagnostic data" гугл выдает ссылку на [сайт](https://www.kroll.com/en/insights/publications/cyber/forensically-unpacking-eventtranscript/parsing-diagnostic-data-with-powershell-and-enhanced-logging), где описан метод парсинга через командлету в Powershell'e
Устанавливаем в Powershell'e командлету Microsoft.DiagnosticDataViewer

```python
Install-Module -Name Microsoft.DiagnosticDataViewer

Enable-DiagnosticDataViewing
```

Исходя из задания ясно, что все события происходили 26 мая между 21:35 и 21:40 -> формируем команду:
```python
Get-DiagnosticData -DiagnosticDataCategory 25 -StartTime(Get-Date -Date "2022-05-26T21:35:00") -EndTime (Get-Date -Date "2022-05-26T21:40:00") | Export-Csv 'C:\path\to\file.csv'
```
Немного изучая получившийся .csv файл находим флаг w40w_c0mp4dr3_d1d_u_f0und_r3534rch




### Флаг


```
vka{w40w_c0mp4dr3_d1d_u_f0und_r3534rch}
```
