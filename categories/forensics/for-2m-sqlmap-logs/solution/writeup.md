## Logs

| Событие | Название | Категория | Сложность |
| :------ | ---- | ---- | ---- |
| VKACTF 2022 | Лехо  | forensic | Средняя |

  
### Описание


> Автор: [ vChuk ]
>
> За лесом дремучим стояло село, да было оно не простое: травы и отвары целебные там готовили, людей лечили. И жил народ в богатстве и здравии, пока однажды в лаборатории №1337 трагедия не случилась. Никто уже не помнит, что произошло, да только с тех пор в краях этих стало чудище появляться. Лихом Одноглазым люд его зовет. И сколько богатырей не пыталось его одолеть, все головы сложили… Не объявился пока тот молодец что Лихо сможет отыскать, побороть, да покой в тот край вернуть.


### Решение

В большом лог-файле необходимо было найти сначала сам сайт. Одним из вариантов нахождения является нахождение по строке 127.0.0.1, предполагая, что админ проверил функциональность. При поиске находим, что было отправлено сообщение /system ping 54896848 (ip в десятичном виде)

После захода на сайт видим, echobot, который может выполнять простейшие действия. Прочитав Log version, видим, что последняя запись была для 0.7, а на сайте стоит версия 0.8.

Из Log version 
```text
Существование записи в базу сведений
```

Из лог-файла выберем все сообщения начинающиеся с / и удалим известные команды, такие как sum, system, lower, upper. В итоге останется /search_query. 

Находим в команде /search_query sql инъекцию. Докрутив её, находим флаг 

![](images/win.png)


### Флаг

```
vka{existence_logs_leads_knowledge_system}
```
